# -*- coding: utf-8 -*-
"""TB_CODIGO.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1xeGCILByGwsJ3F2s1CWFa6uU-x8rRI4q

**Proyecto Final: Unidad 2**

**Entidad: Tb_Codigo**
"""

#Faker es un paquete de Python que genera datos falsos.
!pip install Faker

#Librerías necesarias para la generación de datos.
import pandas as pd
import uuid
import random
from faker import Faker
import datetime

#Librerías para generar cadena de numeros
import random as r
from random import seed

#Librerías para generar fechas
import string
from random import randint
from datetime import datetime

#Variable asignada para el tamaño del conjunto de datos. 
num_iess = 10000

"""- Int_id_codigo: una cadena de números para identificar en este caso un codigo
     - Var_nombre_codigo:tipo de cadena con un nombre de un codigo
     - Int_artículo: cadena de números para representar números
     - Var_estado_codigo: tipo de cadena que describe estado de actividad o no actividad
     - Var_detalle_codigo:una cadena de caracteres para simular información 
     -Int_Id_baselegal: codigo identidificador de la entidad base legal peroen esta tabla es una clave foránea

Se ingresan los atributos como una lista para inicializar un marco de datos de Pandas:
"""

#Lista de 5 características (Atributos)
features = [
    "VAR_ID_CODIGO",
    "VAR_NOMBRE_CODIGO",
    "INT_ARTICULO",
    "VAR_ESTADO_CODIGO",
    "VAR_DETALLE_CODIGO",
    "VAR_ID_BASELEGAL",
]# Creando un DF para estas características
df = pd.DataFrame(columns=features)

"""**id_codigo**"""

#Biblioteca uuid para generar cadena aleatoria de datos para id_codigo.
df['VAR_ID_CODIGO'] = [uuid.uuid4().hex for i in range(num_iess)]

#Genera identificaciones únicas para cada usuario. Si todas las ID en el conjunto de datos son únicas, devuelve True.
print(df['VAR_ID_CODIGO'].nunique()==num_iess)

"""**nombre_codigo**"""

#Los diferentes nombres de codigos.
VAR_NOMBRE_CODIGO= ['Código del Trabajo','Código Cívil','Código Orgánico Integral','Código de Comercio']
#Creacion de los permisos para cada una de las filas
df['VAR_NOMBRE_CODIGO'] = random.choices(
  VAR_NOMBRE_CODIGO , 
    weights=(40,10,10,5), 
    k=num_iess
)

"""**articulo**"""

articulos=[]
#Cantidad de números para la cadena..
size = 2
for i in range(0, num_iess):
  random.seed(datetime.now())
  #Números opcionales para formar la cadena.
  valores = [0,1,2,3,4,5,6,7,8,9]
  articulos=(''.join([str(random.choice(valores)) for i in range(size)]))
  #Se guarda los números 
  df.INT_ARTICULO[i]=articulos

"""**estado_codigo**"""

#Los diferentes nombres de servicios.
VAR_ESTADO_CODIGO= ['Activo','Inactivo']
#Creacion de los permisos para cada una de las filas
df['VAR_ESTADO_CODIGO'] = random.choices(
  VAR_ESTADO_CODIGO, 
    weights=(40,10), 
    k=num_iess
)

"""**detalle_codigo**"""

#Creamos la variale para la descripción de tipo string junto con su longitud de 
#cadena de caracteres
bio=[]
length_of_string = 20

for i in range(0, num_iess):#Creamos la descripcion de la universidad
  random.seed(datetime.now())
  #La descripcion contendra todo tipo de caracteres.
  bio=(''.join(random.SystemRandom().choice(string.ascii_letters + string.digits) for i in range(length_of_string)))
  #Guardamos la descripcion en el atributo DescripcionUn
  df.VAR_DETALLE_CODIGO[i] =bio

"""**id_base_legal**"""

#Biblioteca uuid para generar cadena aleatoria de datos para id_perfil.
df['VAR_ID_BASELEGAL'] = [uuid.uuid4().hex for i in range(num_iess)]

#Genera identificaciones únicas para cada usuario. Si todas las ID en el conjunto de datos son únicas, devuelve True.
print(df['VAR_ID_BASELEGAL'].nunique()==num_iess)

#Visualizar en la tabla los datos generados antes de descargar el excel.
df.head(5)

#Generar excel de los datos.
df.to_csv('TB_CODIGO.csv')